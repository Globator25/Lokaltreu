name: security-gates
on: [pull_request]
jobs:
  security-gates:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: node .github/scripts/test-anti-replay.mjs  # 10 parallel â†’ 1x201, 9x409
      - run: node .github/scripts/test-device-proof.mjs  # Ed25519 proof cases
      - run: node .github/scripts/test-rate-limits.mjs   # /stamps/claim, /rewards/redeem
      - run: node .github/scripts/test-plan-gate.mjs     # 403 PLAN_NOT_ALLOWED
